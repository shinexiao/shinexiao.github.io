<!doctype html>
<html class="theme-next use-motion ">
<head>
  

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>



  <link href='http://fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext' rel='stylesheet' type='text/css'>


<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.3"/>




  <meta name="keywords" content="Hexo,next" />





  <link rel="shorticon icon" type="image/x-icon" href="/favicon.ico?v=0.4.3" />



<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: '',
    analytics: {
      google: ''
    },
    sidebar: 'post'
  };
</script>




  <title> Shine Xiao's Notes </title>
</head>

<body>
  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->

  <div class="container one-column 
   page-home 
">
    <div class="headband"></div>

    <div id="header" class="header">
      <div class="header-inner">
        <h1 class="site-meta">
  <span class="logo-line-before"><i></i></span>
  <a href="/" class="brand">
      <span class="logo">
        <i class="icon-logo"></i>
      </span>
      <span class="site-title">Shine Xiao's Notes</span>
  </a>
  <span class="logo-line-after"><i></i></span>
</h1>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<div class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/">
            <i class="menu-item-icon icon-home"></i> <br />
            首頁
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            <i class="menu-item-icon icon-categories"></i> <br />
            分類
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            <i class="menu-item-icon icon-archives"></i> <br />
            歸檔
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            <i class="menu-item-icon icon-tags"></i> <br />
            標籤
          </a>
        </li>
      
    </ul>
  

  
</div>


      </div>
    </div>

    <div id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">
          
  <div id="posts" class="posts-expand">
    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2015/10/13/ubuntu-server/">
                ubuntu-server
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          發表於 2015-10-13
        </span>

        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <h2 id="ubuntu_搭建JAVA服务器环境">ubuntu 搭建JAVA服务器环境</h2><ol>
<li><p>通过apt-get 安装nginx</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="keyword">get</span> install nginx</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用wget下载tomcat8</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget http:<span class="comment">//apache.dataguru.cn/tomcat/tomcat-8/v8.0.27/bin/apache-tomcat-8.0.27.tar.gz</span></span><br><span class="line">tar zxvf apache-tomcat-<span class="number">8.0</span>.<span class="number">27</span><span class="class">.tar</span><span class="class">.gz</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>配置nginx与tomcat</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> /etc/nginx</span><br><span class="line">sudo touch proxy.<span class="keyword">conf</span></span><br><span class="line">sudo <span class="keyword">vim</span> proxy.<span class="keyword">conf</span></span><br></pre></td></tr></table></figure>
<p>proxy.conf 内容如下</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">proxy_redirect</span>          <span class="built_in">off</span>;</span><br><span class="line"><span class="title">proxy_set_header</span>        Host <span class="variable">$host</span>;</span><br><span class="line"><span class="title">proxy_set_header</span>        X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line"><span class="title">proxy_set_header</span>        X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line"><span class="title">client_max_body_size</span>    <span class="number">20m</span>; <span class="comment">#允许最大上传文件大小</span></span><br><span class="line"><span class="title">client_body_buffer_size</span> <span class="number">128k</span>;</span><br><span class="line"><span class="title">proxy_connect_timeout</span>   <span class="number">300</span>;</span><br><span class="line"><span class="title">proxy_send_timeout</span>      <span class="number">300</span>;</span><br><span class="line"><span class="title">proxy_read_timeout</span>      <span class="number">300</span>;</span><br><span class="line"><span class="title">proxy_buffer_size</span>       <span class="number">4k</span>;</span><br><span class="line"><span class="title">proxy_buffers</span>           <span class="number">4</span> <span class="number">32k</span>;</span><br><span class="line"><span class="title">proxy_busy_buffers_size</span> <span class="number">64k</span>;</span><br><span class="line"><span class="title">proxy_temp_file_write_size</span> <span class="number">64k</span>;</span><br></pre></td></tr></table></figure>
<p>修改nginx.conf内容如下：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">user</span> www-data;</span><br><span class="line"><span class="title">worker_processes</span> <span class="number">4</span>;</span><br><span class="line"><span class="title">pid</span> /run/nginx.pid;</span><br><span class="line"></span><br><span class="line"><span class="title">events</span> &#123;</span><br><span class="line">        <span class="title">worker_connections</span> <span class="number">2048</span>;</span><br><span class="line">        <span class="comment"># multi_accept on;</span></span><br><span class="line">        <span class="title">use</span> <span class="built_in">epoll</span>; <span class="comment">#linux epoll</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title">http</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">##</span></span><br><span class="line">        <span class="comment"># Basic Settings</span></span><br><span class="line">        <span class="comment">##</span></span><br><span class="line"></span><br><span class="line">        <span class="title">sendfile</span> <span class="built_in">on</span>;</span><br><span class="line">        <span class="title">tcp_nopush</span> <span class="built_in">on</span>;</span><br><span class="line">        <span class="title">tcp_nodelay</span> <span class="built_in">on</span>;</span><br><span class="line">        <span class="title">keepalive_timeout</span> <span class="number">65</span>;</span><br><span class="line">        <span class="title">types_hash_max_size</span> <span class="number">2048</span>;</span><br><span class="line">        <span class="comment"># server_tokens off;</span></span><br><span class="line">        <span class="comment"># server_names_hash_bucket_size 64;</span></span><br><span class="line">        <span class="comment"># server_name_in_redirect off;</span></span><br><span class="line"></span><br><span class="line">        <span class="title">include</span> /etc/nginx/mime.types;</span><br><span class="line">        <span class="title">default_type</span> application/octet-stream;</span><br><span class="line"></span><br><span class="line">        <span class="comment">##</span></span><br><span class="line">        <span class="comment"># Logging Settings</span></span><br><span class="line">        <span class="comment">##</span></span><br><span class="line"></span><br><span class="line">        <span class="title">access_log</span> /var/log/nginx/access.log;</span><br><span class="line">        <span class="title">error_log</span> /var/log/nginx/error.log;</span><br><span class="line"></span><br><span class="line">        <span class="comment">##</span></span><br><span class="line">        <span class="comment"># Gzip Settings</span></span><br><span class="line">        <span class="comment">##</span></span><br><span class="line"></span><br><span class="line">        <span class="title">include</span> proxy.conf; <span class="comment">#新增到此处引入proxy.conf</span></span><br><span class="line"></span><br><span class="line">        <span class="title">gzip</span> <span class="built_in">on</span>;<span class="comment">#开启gzip 压缩</span></span><br><span class="line">        <span class="title">gzip_disable</span> <span class="string">"msie6"</span>;</span><br><span class="line">        <span class="comment"># gzip_vary on;</span></span><br><span class="line">        <span class="comment"># gzip_proxied any;</span></span><br><span class="line">        <span class="comment"># gzip_comp_level 6;</span></span><br><span class="line">        <span class="comment"># gzip_buffers 16 8k;</span></span><br><span class="line">        <span class="comment"># gzip_http_version 1.1;</span></span><br><span class="line">        <span class="title">gzip_types</span> text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;</span><br><span class="line"></span><br><span class="line">        <span class="title">include</span> /etc/nginx/conf.d/<span class="regexp">*.conf</span>;</span><br><span class="line">        <span class="title">include</span> /etc/nginx/sites-enabled/*;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>修改sites-enabled 下面的 default 文件，新增虚拟服务器</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">upstream server&#123;</span><br><span class="line">      <span class="preprocessor">#ip_hash; #根据ip分配后端服务器</span></span><br><span class="line">      server <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">8081</span> weight=<span class="number">1</span>;</span><br><span class="line">      <span class="preprocessor">#server <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">8082</span> weight=<span class="number">1</span>; #负载均衡</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">        listen <span class="number">80</span>;</span><br><span class="line">        server_name yourdomain; <span class="preprocessor">#与tomcat host 节点名称一致</span></span><br><span class="line">        location / &#123;</span><br><span class="line">                proxy_pass http:<span class="comment">//server;</span></span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>编写tomcat启动脚本,命名为tomcat81</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="shebang">#!/bin/bash</span></span><br><span class="line"><span class="comment"># Tomcat82 auto-start</span></span><br><span class="line"><span class="comment"># description: Auto-starts tomcat82</span></span><br><span class="line"><span class="comment"># processname: tomcat82</span></span><br><span class="line"><span class="comment"># pidfile: /var/run/tomcat82.pid</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/bin/jvm/jdk1.<span class="number">7.0</span>_79</span><br><span class="line"><span class="keyword">case</span> <span class="variable">$1</span> <span class="keyword">in</span></span><br><span class="line">start)</span><br><span class="line">        sh /opt/tomcat/tomcat82/bin/startup.sh</span><br><span class="line">        ;;</span><br><span class="line">stop)</span><br><span class="line">        sh /opt/tomcat/tomcat82/bin/shutdown.sh</span><br><span class="line">        ;;</span><br><span class="line">restart)</span><br><span class="line">        sh /opt/tomcat/tomcat82/bin/shutdown.sh</span><br><span class="line">        sh /opt/tomcat/tomcat82/bin/startup.sh</span><br><span class="line">        ;;</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line"><span class="built_in">exit</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>把脚本复制到init.d下面，当系统启动时自动启动tomcat</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo cp tomcat81 /etc/init.<span class="keyword">d</span>/tomcat81</span><br><span class="line">sudo chmod 777 /etc/init.<span class="keyword">d</span>/tomcat81</span><br><span class="line">sudo <span class="keyword">update</span>-rc.<span class="keyword">d</span> tomcat81 defaults</span><br></pre></td></tr></table></figure>
<p>tomcat使用memcached实现session共享配置</p>
<p>安装memcached</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="built_in">get</span> install memcached</span><br><span class="line">sudo service memcached <span class="built_in">start</span></span><br></pre></td></tr></table></figure>
<p>下载tomcat依赖包</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">wget <span class="string">http:</span><span class="comment">//repo1.maven.org/maven2/de/javakaffee/msm/memcached-session-manager-tc8/1.9.0-RC1/memcached-session-manager-tc8-1.9.0-RC1.jar</span></span><br><span class="line">wget <span class="string">http:</span><span class="comment">//repo1.maven.org/maven2/net/spy/spymemcached/2.11.1/spymemcached-2.11.1.jar</span></span><br><span class="line">wget <span class="string">http:</span><span class="comment">//repo1.maven.org/maven2/de/javakaffee/msm/msm-kryo-serializer/1.9.0-RC1/msm-kryo-serializer-1.9.0-RC1.jar</span></span><br><span class="line">wget <span class="string">http:</span><span class="comment">//repo1.maven.org/maven2/de/javakaffee/kryo-serializers/0.34/kryo-serializers-0.34.jar</span></span><br><span class="line">wget <span class="string">http:</span><span class="comment">//repo1.maven.org/maven2/com/esotericsoftware/kryo/3.0.3/kryo-3.0.3.jar</span></span><br><span class="line">wget <span class="string">http:</span><span class="comment">//repo1.maven.org/maven2/com/esotericsoftware/minlog/1.3.0/minlog-1.3.0.jar</span></span><br><span class="line">wget <span class="string">http:</span><span class="comment">//repo1.maven.org/maven2/com/esotericsoftware/reflectasm/1.11.0/reflectasm-1.11.0.jar</span></span><br><span class="line">wget <span class="string">http:</span><span class="comment">//repo1.maven.org/maven2/org/ow2/asm/asm/5.0.4/asm-5.0.4.jar</span></span><br><span class="line">wget <span class="string">http:</span><span class="comment">//maven.oschina.net/service/local/repositories/ibiblio/content/org/objenesis/objenesis/2.2/objenesis-2.2.jar</span></span><br></pre></td></tr></table></figure>
<p>文件复制到tomcat 的lib 目录下，同时复制一份tomcat81 为 tomcat82，然后分别修改tomcat的端口为8081与8082,修改tomcat的context.xml文件，<br>在Context节点下，增加内容如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">Manager</span> <span class="attribute">className</span>=<span class="value">"de.javakaffee.web.msm.MemcachedBackupSessionManager"</span></span><br><span class="line">  <span class="attribute">memcachedNodes</span>=<span class="value">"n1:127.0.0.1:11211"</span></span><br><span class="line">  <span class="attribute">sticky</span>=<span class="value">"false"</span></span><br><span class="line">  <span class="attribute">sessionBackupAsync</span>=<span class="value">"false"</span></span><br><span class="line">  <span class="attribute">requestUriIgnorePattern</span>=<span class="value">".*\.(ico|png|gif|jpg|css|js)$"</span></span><br><span class="line">  <span class="attribute">transcoderFactoryClass</span>=<span class="value">"de.javakaffee.web.msm.serializer.kryo.KryoTranscoderFactory"</span></span><br><span class="line">  /&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>使用新硬盘作为数据盘</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo fdisk -lu <span class="comment">#查询硬盘</span></span><br><span class="line">sudo fdisk -t ext4 /dev/xvdb <span class="comment">#阿里云的硬盘,新建扩展分区为ext4文件系统</span></span><br><span class="line"><span class="comment">#根据提示输入m,然后选择对应的操作 e （扩展分区）</span></span><br><span class="line">sudo mkfs ext4 /dev/xvdb <span class="comment">#格式化分区</span></span><br><span class="line">sudo <span class="keyword">mkdir</span> /wwwroot <span class="comment">#新建文件夹用来挂载分区</span></span><br><span class="line">sudo mount /dev/xvdb /wwwroot <span class="comment">#挂载分区</span></span><br><span class="line">sudo df -h <span class="comment">#查看硬盘使用量</span></span><br><span class="line"><span class="comment">#编辑fstab文件，使分区自动开机自动挂载</span></span><br><span class="line">sudo vim fstab</span><br></pre></td></tr></table></figure>
<p>fstab内容如下</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># /etc/fsta<span class="variable">b:</span> static <span class="keyword">file</span> <span class="built_in">system</span> information.</span><br><span class="line">#</span><br><span class="line"># Use <span class="string">'blkid'</span> <span class="keyword">to</span> <span class="keyword">print</span> the universally unique identifier <span class="keyword">for</span> <span class="keyword">a</span></span><br><span class="line"># device; this may <span class="keyword">be</span> used with UUID= <span class="keyword">as</span> <span class="keyword">a</span> more robust way <span class="keyword">to</span> name devices</span><br><span class="line"># that works even <span class="keyword">if</span> disks are added <span class="built_in">and</span> removed. See fstab(<span class="number">5</span>).</span><br><span class="line">#</span><br><span class="line"># &lt;<span class="keyword">file</span> <span class="built_in">system</span>&gt; &lt;mount point&gt;   &lt;<span class="built_in">type</span>&gt;  &lt;<span class="keyword">options</span>&gt;       &lt;dump&gt;  &lt;pass&gt;</span><br><span class="line">UUID=af414ad8-<span class="number">9936</span>-<span class="number">46</span><span class="keyword">cd</span>-b074-<span class="number">528854656</span>fcd / ext4 errors=remount-ro <span class="number">0</span> <span class="number">1</span></span><br><span class="line">/dev/xvdb       /wwwroot        ext4    auto    <span class="number">0</span>       <span class="number">0</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>调整tomcat8的内存</p>
<p>修改catalina.sh，增加JAVA_OPTS配置内容：</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JAV<span class="built_in">A_OPTS</span>=<span class="string">"-server -Xms1024m -Xmx2048m -XX:PermSize=64M -XX:MaxPermSize=256m"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>使用scp上传文件到服务器</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">scp</span> 本地文件路径 用户<span class="at_rule">@<span class="keyword">服务器地址:服务器文件存放路径</span></span></span><br></pre></td></tr></table></figure>
<p>最后，系统搭建完成，tomcat虚拟服务器的配置就自行配置吧。^_^</p>
</li>
</ol>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2015/08/05/docker/">
                docker
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          發表於 2015-08-05
        </span>

        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <h2 id="ubuntu_安装docker">ubuntu 安装docker</h2><p>ubuntu下安装docker有2种方式：</p>
<ol>
<li><p>通过apt-get 安装</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">       sudo apt-get <span class="operator"><span class="keyword">update</span></span><br><span class="line">sudo apt-<span class="keyword">get</span> <span class="keyword">install</span> -y docker.io</span><br><span class="line">sudo <span class="keyword">ln</span> -sf /usr/<span class="keyword">bin</span>/docker.io /usr/<span class="keyword">local</span>/<span class="keyword">bin</span>/docker  </span><br><span class="line">sudo sed -<span class="keyword">i</span> <span class="string">'$acomplete -F _docker docker'</span> /etc/bash_completion.<span class="keyword">d</span>/docker.io           </span></span><br></pre></td></tr></table></figure>
</li>
<li><p>通过Docker源安装</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="built_in">get</span> <span class="keyword">update</span></span><br><span class="line">sudo apt-<span class="built_in">get</span> install wget</span><br><span class="line">wget -qO- http<span class="variable">s:</span>//<span class="built_in">get</span>.docker.<span class="keyword">com</span>/ | <span class="keyword">sh</span></span><br><span class="line">sudo docker run hello-world #验证安装成功</span><br></pre></td></tr></table></figure>
</li>
</ol>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2015/07/13/cocos2dlua/">
                cocos2dlua
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          發表於 2015-07-13
        </span>

        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <h2 id="cocos2d-lua_学习总结">cocos2d-lua 学习总结</h2><ol>
<li><p>框架使用cocos2d 3.6</p>
<p>项目创建</p>
 <figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cocos new -<span class="tag">p</span> com<span class="class">.easymin</span><span class="class">.game</span> -l lua projectName</span><br></pre></td></tr></table></figure>
</li>
<li><p>几何</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cc<span class="class">.RectMake</span>, cc<span class="class">.SizeMake</span>, cc.PointMake</span><br></pre></td></tr></table></figure>
<p>在lua中替换为</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cc.<span class="function"><span class="title">rect</span><span class="params">()</span></span>, cc.<span class="function"><span class="title">size</span><span class="params">()</span></span>, cc.<span class="function"><span class="title">p</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>注册事件分发器</p>
 <figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cc<span class="class">.Director</span><span class="class">.getInstance</span>().<span class="function"><span class="title">getTouchDispatcher</span><span class="params">()</span></span>.<span class="function"><span class="title">addTargetedDelegate</span><span class="params">()</span></span></span><br><span class="line"></span><br><span class="line">cc<span class="class">.Director</span><span class="class">.getInstance</span>().<span class="function"><span class="title">getTouchDispatcher</span><span class="params">()</span></span>.<span class="function"><span class="title">addStandardDelegate</span><span class="params">()</span></span></span><br><span class="line"></span><br><span class="line">cc<span class="class">.Director</span><span class="class">.getInstance</span>().<span class="function"><span class="title">getTouchDispatcher</span><span class="params">()</span></span>.<span class="function"><span class="title">removeDelegate</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure>
<p> 改为</p>
 <figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cc.<span class="function"><span class="title">registerTargetedDelegate</span><span class="params">()</span></span></span><br><span class="line"></span><br><span class="line">cc.<span class="function"><span class="title">registerStandardDelegate</span><span class="params">()</span></span></span><br><span class="line"></span><br><span class="line">cc.<span class="function"><span class="title">unregisterTouchDelegate</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>粒子系统中的cc.ParticleSystemQuad被合并到cc.ParticleSystem：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">cc</span><span class="class">.ParticleSystemQuad</span><span class="class">.create</span>(); <span class="tag">-</span>&gt; <span class="tag">cc</span><span class="class">.ParticleSystem</span><span class="class">.create</span>();</span><br></pre></td></tr></table></figure>
</li>
<li><p>颜色生成</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cc.Color4B(<span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>containsPoint修改为：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cc.<span class="function"><span class="title">rectContainsPoint</span><span class="params">(rect,point)</span></span></span><br></pre></td></tr></table></figure>
</li>
</ol>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2015/07/09/appstorereview/">
                appstorereview
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          發表於 2015-07-09
        </span>

        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <h2 id="上架被拒血泪史">上架被拒血泪史</h2><ol>
<li><p>Vip申请，但是未说明如何申请及申请成功后vip权益。</p>
<ul>
<li>What’s the VIP for?</li>
<li>How does the user obtain the VIP？</li>
<li>What services do users could be get after obtaining the VIP?</li>
</ul>
</li>
</ol>
<ol>
<li><p>App包含有通过企业版下载的链接和相关的二维码。</p>
<p>During review, your app installed or launched executable code, which is a violation of the App Store Review Guidelines. Specifically, your app uses the itms-services URL scheme to install an application.</p>
</li>
<li><p>提供的演示帐号不能进行登陆。</p>
<p>Specifically, the demo account you provided is invalid. We’ve attached screenshot(s) for your reference.</p>
</li>
<li><p>程序内出现了更新提示或者点击更新检测功能。</p>
<p>Your app includes an update button or alerts the user to update the app. To avoid user confusion, app version updates must utilize the iOS built-in update mechanism.</p>
</li>
</ol>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2015/07/08/appium/">
                appium入门指南
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          發表於 2015-07-08
        </span>

        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <h2 id="安装appium">安装appium</h2><ul>
<li><p>node安装</p>
<figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm -g --<span class="keyword">registry</span> <span class="keyword">http</span>://<span class="keyword">registry</span>.cnpmjs.org  install appium</span><br></pre></td></tr></table></figure>
</li>
<li><p>下载安装</p>
<p><a href="https://bitbucket.org/appium/appium.app/downloads/appium-1.4.0.dmg" target="_blank" rel="external">appium 官网</a></p>
</li>
</ul>
<h2 id="运行appium">运行appium</h2><ul>
<li><p>command下输入命令 -U 后面为真机设备号 —app 为包名</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">appium -U <span class="number">0</span>d74b93b6c6db8dfa18beb37bdca25f787467823 --app com<span class="class">.easymin</span><span class="class">.daijia</span><span class="class">.driver</span><span class="class">.emdaijia</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="安装appium_client">安装appium client</h2><ul>
<li><p>ruby客户端安装</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gem <span class="operator"><span class="keyword">update</span> <span class="comment">--system</span></span><br><span class="line">gem <span class="keyword">update</span> bundler</span><br><span class="line">gem <span class="keyword">uninstall</span> -aIx appium_lib</span><br><span class="line">gem <span class="keyword">install</span> <span class="comment">--no-rdoc --no-ri appium_lib</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>python客户端安装</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip <span class="operator"><span class="keyword">install</span> Appium-Python-<span class="keyword">Client</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>java客户端安装</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">groupId</span>&gt;</span>io.appium<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>java-client<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>nodejs客户端安装</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm <span class="keyword">install</span> wd</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="初始化代码">初始化代码</h2><ul>
<li><p>java初始化代码</p>
<p>安卓</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">DesiredCapabilities capabilities = <span class="keyword">new</span> DesiredCapabilities();</span><br><span class="line">capabilities.setCapability(<span class="string">"deviceName"</span>,<span class="string">"Android Emulator"</span>);<span class="comment">//设备名称</span></span><br><span class="line">capabilities.setCapability(<span class="string">"platformVersion"</span>, <span class="string">"4.4"</span>);<span class="comment">//平台版本</span></span><br><span class="line">capabilities.setCapability(<span class="string">"app"</span>, <span class="string">"com.easymin.daijia.driver.emdaijia"</span>);<span class="comment">//app打包文件路径</span></span><br><span class="line">capabilities.setCapability(<span class="string">"appPackage"</span>, <span class="string">"com.easymin.daijia.client"</span>);<span class="comment">//包名</span></span><br><span class="line">capabilities.setCapability(<span class="string">"appActivity"</span>, <span class="string">".MainActivity"</span>);<span class="comment">//activity名称</span></span><br><span class="line">AndroidDriver driver = <span class="keyword">new</span> AndroidDriver(<span class="keyword">new</span> URL(<span class="string">"http://127.0.0.1:4723/wd/hub"</span>), capabilities);</span><br></pre></td></tr></table></figure>
<p>iphone</p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">DesiredCapabilities capabilities = new DesiredCapabilities();</span><br><span class="line">capabilities.<span class="built_in">set</span>Capability(CapabilityType.VERSION,<span class="string">"8.4"</span>);</span><br><span class="line">capabilities.<span class="built_in">set</span>Capability(CapabilityType.PLATFORM,  Platform.YOSEMITE);</span><br><span class="line">capabilities.<span class="built_in">set</span>Capability(<span class="string">"deviceName"</span>,  <span class="string">"xiao的 iPhone"</span>);</span><br><span class="line">capabilities.<span class="built_in">set</span>Capability(<span class="string">"platformName"</span>,<span class="string">"ios"</span>);</span><br><span class="line">capabilities.<span class="built_in">set</span>Capability(MobileCapabilityType.APP,<span class="string">"com.easymin.daijia.driver.emdaijia"</span>);</span><br><span class="line">driver = new IOSDriver(new URL(<span class="string">"http://0.0.0.0:4723/wd/hub"</span>),capabilities);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="运行测试提示缺少ideviceinstaller">运行测试提示缺少ideviceinstaller</h3><p>  安装ideviceinstaller</p>
  <figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">brew </span>install ideviceinstaller</span><br></pre></td></tr></table></figure>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
  </div>

  

        </div>

        
      </div>


      
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <div id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      <div class="site-overview">
        <div class="site-author motion-element">
          <img class="site-author-image" src="/images/default_avatar.jpg" alt="Shine Xiao" />
          <p class="site-author-name">Shine Xiao</p>
        </div>
        <p class="site-description motion-element"></p>
        <div class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">5</span>
              <span class="site-state-item-name">文章</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            <a href="/categories">
              <span class="site-state-item-count">0</span>
              <span class="site-state-item-name">分類</span>
              </a>
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">9</span>
              <span class="site-state-item-name">標籤</span>
              </a>
          </div>

        </div>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>
        
      </div>

      

    </div>
  </div>


    </div>

    <div id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; &nbsp; 
  2015
  <span class="with-love">
    <i class="icon-heart"></i>
  </span>
  <span class="author">Shine Xiao</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 強力驅動
</div>

<div class="theme-info">
  主題 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT
  </a>
</div>



      </div>
    </div>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.3"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.3"></script>
  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/js/motion_global.js?v=0.4.3" id="motion.global"></script>



  <script type="text/javascript" src="/js/search-toggle.js"></script>

  

  <script type="text/javascript">
    $(document).ready(function () {
      if (CONFIG.sidebar === 'always') {
        displaySidebar();
      }
    });
  </script>

  

  
  
  

  




  
  

  
  <!-- lazyload -->
  <script type="text/javascript" src="/js/lazyload.js"></script>
      <script type="text/javascript">
        jQuery(function() {          
            jQuery("#posts img").lazyload({
              placeholder:"http://www.arao.me/loading.gif",  
                effect:"fadeIn"
              });
            });
    </script>   
</body>
</html>
